<!DOCTYPE html>
<html lang="ja">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
      crossorigin="anonymous"
    />

    <!-- Google Material icons -->
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />

    <title>kakeibo7</title>
  </head>
  <body>
    <header>
      <nav
        class="
          navbar navbar-expand-sm navbar-toggleable-sm navbar-light
          bg-white
          border-bottom
          box-shadow
          mb-3
        "
      >
        <div class="container">
          <a class="navbar-brand" href="#">kakeibo7</a>
          <button
            class="navbar-toggler"
            type="button"
            data-toggle="collapse"
            data-target=".navbar-collapse"
            aria-controls="navbarSupportedContent"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div
            class="
              navbar-collapse
              collapse
              d-sm-inline-flex
              flex-sm-row-reverse
            "
          >
            <ul class="navbar-nav flex-grow-1">
              <li class="nav-item">
                <a class="nav-link text-dark" href="#">リスト</a>
              </li>
              <li class="nav-item">
                <a class="nav-link text-dark" href="#">精算</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>
    <div class="container">
      <main role="main" class="pb-3">
        <h2>追加</h2>

        <hr />
        <div class="row">
          <div class="col-md-4">
              <input type="hidden" asp-for="id" />
              <div class="form-group row">
                <label for="PayDate" class="col col-form-label">支払日</label>
                <div class="col">
                  <input type="date" class="form-control form-control-sm" id="PayDate" />
                </div>
              </div>
              <div class="form-group row">
                <label for="PayItem" class="col col-form-label">購入物名</label>
                <div class="col">
                  <input class="form-control form-control-sm" id="PayItem" />
                </div>
              </div>
              <div class="form-group row">
                <label for="Price" class="col col-form-label">支出額</label>
                <div class="col">
                  <input
                  type="number"
                  class="form-control form-control-sm"
                  id="Price"
                />
                </div>
              </div>
              <div class="form-group row">
                <label for="UserName" class="col col-form-label">ユーザー名</label>
                <div class="col">
                  <select class="form-control form-control-sm" id="UserName">
                    <option value="user1">ユーザー1</option>
                    <option value="user2">ユーザー2</option>
                  </select>
                </div>
              </div>
              <div class="form-group row">
                <label for="Payment" class="col col-form-label">支払方法名</label>
                <div class="col">
                  <select class="form-control form-control-sm" id="Payment">
                    <option value="payment1">支払い方法1</option>
                    <option value="payment2">支払い方法2</option>
                  </select>
                </div>
              </div>
              <div class="form-group row">
                <label for="CostType" class="col col-form-label">支出分類名</label>
                <div class="col">
                  <select class="form-control form-control-sm" id="CostType">
                    <option value="9991">分類1</option>
                    <option value="9992">分類2</option>
                  </select>
                </div>
              </div>
              <div class="form-group row">
                <label for="StartDate" class="col col-form-label">期間開始日</label>
                <div class="col">
                  <input
                  type="date"
                  class="form-control form-control-sm"
                  id="StartDate"
                />
                </div>
              </div>
              <div class="form-group row">
                <label for="EndDate" class="col col-form-label">期間終了日</label>
                <div class="col">
                  <input
                  type="date"
                  class="form-control form-control-sm"
                  id="EndDate"
                />
                </div>
              </div>
              <div class="form-group row">
                <label for="ForMonth" class="col col-form-label">○月分</label>
                <div class="col">
                  <input class="form-control form-control-sm" id="ForMonth" />
                </div>
              </div>
              <button class="btn btn-success btn-block" onClick="addExpense();">追加</button>
          </div>
        </div>
        <br />

        <div>
          <a class="btn btn-outline-secondary" href="#" role="button"
            >一覧に戻る</a
          >
        </div>
      </main>
    </div>

    <footer class="border-top footer text-muted">
      <div class="container">&copy; 2021 - kakeibo7</div>
    </footer>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script
      src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
      integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
      integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
      integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
      crossorigin="anonymous"
    ></script>
    <!-- My JavaScript -->
    <script>
      function addExpense() {
      const newExpense = {
        pay_user: {
          id: document.getElementById("UserName").options[document.getElementById("UserName").selectedIndex].value || "",
          name: document.getElementById("UserName").options[document.getElementById("UserName").selectedIndex].text || ""
        },
        pay_date: document.getElementById("PayDate").value || "",
        pay_item: document.getElementById("PayItem").value || "",
        price: parseInt(document.getElementById("Price").value, 10) || 0,
        cost_type: {
          id: parseInt(document.getElementById("CostType").options[document.getElementById("CostType").selectedIndex].value, 10) || 0,
          name: document.getElementById("CostType").options[document.getElementById("CostType").selectedIndex].text || ""
        },
        start_date: document.getElementById("StartDate").value || "",
        end_date: document.getElementById("EndDate").value || "",
        target_month: document.getElementById("ForMonth").value || "",
      }

      console.log(newExpense);

      const method = "POST";
      const body = JSON.stringify(newExpense);
      const headers = {
        'Accept': 'application/json',
        'Content-Type': 'application/json'
      };
      fetch("http://localhost:4010/kakeibo/2021/10/30", {method, headers, body})
      .then((res)=> res.json())
      .then(res => console.log(res))
      .catch(err => console.log(err));
      }
    </script>
  </body>
</html>
